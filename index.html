<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tablero Operativo | Tráfico - Transporte San José S.A</title>

  <link rel="stylesheet" href="/tablero-kpi/styles.css?v=10" />
  <script defer src="/tablero-kpi/app.js?v=10"></script>
</head>

<body>
  <header class="topbar" id="topbar">
    <div class="brand">
      <div class="logo">TSJ</div>
      <div class="brand-text">
        <div class="title">Tablero Operativo de Tráfico</div>
        <div class="subtitle">Transporte San José S.A</div>
      </div>
    </div>

    <div class="right">
      <div id="now" class="pill"></div>
      <div id="conn" class="pill pill-warn">Conectando…</div>
      <button id="refreshBtn" class="btn">Actualizar</button>
    </div>
  </header>

  <main class="container" id="main">
    <section class="panel card" id="filtersPanel">
      <div class="panel-head">
        <div>
          <div class="panel-title">Filtros</div>
          <div class="panel-subtitle">Se aplican a la hoja activa</div>
        </div>

        <div class="panel-actions">
          <button id="todayBtn" class="btn btn-ghost" type="button">Hoy</button>
          <button id="clearBtn" class="btn btn-ghost" type="button">Limpiar</button>
          <button id="toggleFiltersBtn" class="btn btn-ghost" type="button">Ocultar filtros</button>

          <label class="switch" title="Vista compacta">
            <input id="compactToggle" type="checkbox" />
            <span class="slider"></span>
          </label>
          <span class="switch-label">Compacta</span>

          <label class="switch" title="Vista pared">
            <input id="wallToggle" type="checkbox" />
            <span class="slider"></span>
          </label>
          <span class="switch-label">Pared</span>
        </div>
      </div>

      <div class="filters" id="filtersGrid">
        <div class="field">
          <label>Fecha</label>
          <input type="date" id="dateFilter" />
          <div class="hint">Si existe FECHA/DIA, filtra por esa fecha.</div>
        </div>

        <div class="field">
          <label>Modo fecha</label>
          <select id="dateMode">
            <option value="today" selected>Solo hoy</option>
            <option value="all">Todas</option>
          </select>
          <div class="hint">Modo operativo recomendado: Solo hoy.</div>
        </div>

        <div class="field">
          <label>Línea</label>
          <select id="lineFilter">
            <option value="">Todas</option>
          </select>
          <div class="hint">Se completa automáticamente.</div>
        </div>

        <div class="field">
          <label>Interno</label>
          <input type="text" id="internoFilter" placeholder="Ej: 105, 211…" />
          <div class="hint">Coincidencia parcial.</div>
        </div>

        <div class="field">
          <label>Estado</label>
          <select id="statusFilter">
            <option value="">Todos</option>
            <option value="ABIERTO">ABIERTO</option>
            <option value="EN PROCESO">EN PROCESO</option>
            <option value="CERRADO">CERRADO</option>
          </select>
          <div class="hint">Requiere columna ESTADO.</div>
        </div>

        <div class="field">
          <label>Búsqueda</label>
          <input type="text" id="q" placeholder="Buscar en cualquier columna…" />
          <div class="hint">Fallas / motivo / resolución.</div>
        </div>

        <div class="field">
          <label>Auto-actualización</label>
          <select id="autoRefresh">
            <option value="0">Off</option>
            <option value="30">30s</option>
            <option value="60" selected>60s</option>
            <option value="120">2 min</option>
            <option value="300">5 min</option>
          </select>
          <div class="hint">Refresca desde Google Sheets.</div>
        </div>

        <div class="field">
          <label>Vista</label>
          <select id="density">
            <option value="normal" selected>Normal</option>
            <option value="compact">Compacta</option>
            <option value="ultra">Ultra compacta</option>
          </select>
          <div class="hint">Más filas visibles en monitor.</div>
        </div>
      </div>
    </section>

    <section class="tabs-wrap">
      <div id="tabs" class="tabs"></div>

      <div class="counters">
        <div class="counter">
          <div class="counter-label">Total hoja</div>
          <div id="cntTotal" class="counter-value">—</div>
        </div>
        <div class="counter">
          <div class="counter-label">Hoy</div>
          <div id="cntToday" class="counter-value">—</div>
        </div>
        <div class="counter">
          <div class="counter-label">Mostrando</div>
          <div id="cntShowing" class="counter-value">—</div>
        </div>
        <div class="counter">
          <div class="counter-label">Abiertos</div>
          <div id="cntOpen" class="counter-value">—</div>
        </div>
        <div class="counter">
          <div class="counter-label">En proceso</div>
          <div id="cntProg" class="counter-value">—</div>
        </div>
        <div class="counter">
          <div class="counter-label">Cerrados</div>
          <div id="cntClosed" class="counter-value">—</div>
        </div>
      </div>
    </section>

    <section id="content" class="content"></section>
  </main>

  <footer class="footer" id="footer">
    <div>Tablero Operativo • Vista de lectura • Fuente: Google Sheets</div>
  </footer>
</body>
</html>
